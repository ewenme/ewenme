<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"  lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<meta name="description" content="ewen&#39;s personal site.">

<title>Building open football player transfer data | ewen</title>

<meta property='og:title' content='Building open football player transfer data - ewen'>
<meta property='og:description' content='Collating player transfers to and from football clubs in major European leagues.'>
<meta property='og:url' content='https://ewen.io/2018/08/27/building-open-football-player-transfer-data/'>
<meta property='og:site_name' content='ewen'>
<meta property='og:type' content='article'><meta property='og:image' content='https://www.gravatar.com/avatar/5195cc1fab1660e62eda3a5f3093e126?s=256'><meta property='article:section' content='Blog'><meta property='article:tag' content='football'><meta property='article:tag' content='data-viz'><meta property='article:tag' content='r'><meta property='article:published_time' content='2018-08-27T00:00:00Z'/><meta property='article:modified_time' content='2018-08-27T00:00:00Z'/><meta name='twitter:card' content='summary_large_image'><meta name='twitter:site' content='@ewen_'><meta name='twitter:creator' content='@ewen_'>

<link href="https://ewen.io/index.xml" rel="alternate" type="application/rss+xml" title="ewen" />

<link rel="stylesheet" href="/css/style.css"/><link rel='stylesheet' href='https://ewen.io/css/custom.css'><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
</head>
<body>
<section class="section">
  <div class="container">
    <nav class="nav">
      <div class="nav-left">
        <a class="nav-item" href="https://ewen.io/"><h1 class="title is-4">ewen</h1></a>
      </div>
      <div class="nav-right">
        <nav class="nav-item level is-mobile"><a class="level-item" aria-label="email" href='mailto:ewenhenderson@gmail.com' target='_blank' rel='noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
    <polyline points="22,6 12,13 2,6"/>
    
  </svg></i>
            </span>
          </a><a class="level-item" aria-label="github" href='https://github.com/ewenme' target='_blank' rel='noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"/>
    
  </svg></i>
            </span>
          </a><a class="level-item" aria-label="rss" href='/index.xml' target='_blank' rel='noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle>
    
  </svg></i>
            </span>
          </a><a class="level-item" aria-label="twitter" href='https://twitter.com/ewen_' target='_blank' rel='noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"/>
    
  </svg></i>
            </span>
          </a></nav>
      </div>
    </nav>

    <nav class="nav">
      

      
    </nav>

  </div>
</section>

<section class="section">
  <div class="container">
    <div class="subtitle tags is-6 is-pulled-right">
      
      
<a class="subtitle is-6" href="/tags/football">#football</a>



  
  | <a class="subtitle is-6" href="/tags/data-viz">#data-viz</a>
  
  | <a class="subtitle is-6" href="/tags/r">#r</a>
  

      
    </div>
    <h2 class="subtitle is-6">August 27, 2018</h2>
    <h1 class="title">Building open football player transfer data</h1>
    
    <div class="content">
      <script src="/rmarkdown-libs/kePrint/kePrint.js"></script>


<p>Around this time last year I ran <a href="https://ewen.io/2017/09/07/unravelling-the-european-football-transfer-window/">a post on European football transfers</a>, taking in the 2017/18 season’s summer window. I got a bit of an itch to refresh this work when the 2018/19 window hit. The aforementioned itch led to me getting in too deep and scraping all major European league transfers going back to the year 2000, naturally.</p>
<p>Here, I tell a short story about how this open data was built and showcases some visualisation pieces that utilised that effort.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> Hopefully this can encourage others to share whatever neat stuff they tap into.</p>
<div id="building-the-data" class="section level2">
<h2>Building the data</h2>
<p>I eventually settled on <del>scraping</del> using <a href="https://www.theguardian.com/football/ng-interactive/2017/jun/22/transfer-window-2017-every-deal-in-europes-top-five-leagues">the Guardian’s Transfer Interactive</a> to power my previous work. This source included transfer timestamps, which allowed for some intra-window time series stuff - it remains handily <a href="https://github.com/Worville/guardian_transfers">hosted by Tom Worville in a public, flat-file format</a>. However, it isn’t really set up for investigating historical trends as the Guardian has only run this interactive since 2017, as far as I can tell.</p>
<p>Enter <a href="https://www.transfermarkt.co.uk/">Transfermarkt</a>, a data goldmine of player transfers for a number of major European leagues (e.g. English Premier League, Spanish La Liga, Italian Serie A) and some other oddities (my personal favourite is <a href="https://www.transfermarkt.co.uk/spieler/vatersohnnationalspieler/statistik">this list of father/son combos for national teams - glorious and appreciated</a>). Season-level stats like player transfers run back for quite a few seasons, joyously arranged in predictable html tables for bountiful scraping. I wrote a short scraping program<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a> to collect and clean up player transfers for these (and other) leagues, back to the 2000/01 season (N.B. this decision was entirely arbitrary).</p>
<p>Et voila - the data is now freely available, <a href="https://github.com/ewenme/footy-transfer-data/tree/master/data">hosted on Github as flat .csv files</a> (in accordance with Transfermarkt’s <a href="https://www.transfermarkt.co.uk/intern/anb">terms of use</a>)<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a>. Here’s a preview, lovingly featuring the deal taking Mr. Igors Stepanovs to Arsenal.</p>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; ">
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
club
</th>
<th style="text-align:left;">
name
</th>
<th style="text-align:right;">
age
</th>
<th style="text-align:left;">
position
</th>
<th style="text-align:left;">
club_involved
</th>
<th style="text-align:left;">
fee
</th>
<th style="text-align:left;">
transfer_movement
</th>
<th style="text-align:right;">
fee_cleaned
</th>
<th style="text-align:left;">
league
</th>
<th style="text-align:right;">
year
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Arsenal FC
</td>
<td style="text-align:left;">
Sylvain WiltordS. Wiltord
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:left;">
Second Striker
</td>
<td style="text-align:left;">
G. Bordeaux
</td>
<td style="text-align:left;">
£15.75m
</td>
<td style="text-align:left;">
in
</td>
<td style="text-align:right;">
15.75
</td>
<td style="text-align:left;">
premier-league
</td>
<td style="text-align:right;">
2000
</td>
</tr>
<tr>
<td style="text-align:left;">
Arsenal FC
</td>
<td style="text-align:left;">
Francis JeffersF. Jeffers
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:left;">
Centre-Forward
</td>
<td style="text-align:left;">
Everton
</td>
<td style="text-align:left;">
£13.77m
</td>
<td style="text-align:left;">
in
</td>
<td style="text-align:right;">
13.77
</td>
<td style="text-align:left;">
premier-league
</td>
<td style="text-align:right;">
2000
</td>
</tr>
<tr>
<td style="text-align:left;">
Arsenal FC
</td>
<td style="text-align:left;">
LaurénLaurén
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:left;">
Right-Back
</td>
<td style="text-align:left;">
RCD Mallorca
</td>
<td style="text-align:left;">
£9.63m
</td>
<td style="text-align:left;">
in
</td>
<td style="text-align:right;">
9.63
</td>
<td style="text-align:left;">
premier-league
</td>
<td style="text-align:right;">
2000
</td>
</tr>
<tr>
<td style="text-align:left;">
Arsenal FC
</td>
<td style="text-align:left;">
Robert PirèsR. Pirès
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:left;">
Left Midfield
</td>
<td style="text-align:left;">
Marseille
</td>
<td style="text-align:left;">
£8.82m
</td>
<td style="text-align:left;">
in
</td>
<td style="text-align:right;">
8.82
</td>
<td style="text-align:left;">
premier-league
</td>
<td style="text-align:right;">
2000
</td>
</tr>
<tr>
<td style="text-align:left;">
Arsenal FC
</td>
<td style="text-align:left;">
Tomas DanileviciusT. Danilevicius
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:left;">
Centre-Forward
</td>
<td style="text-align:left;">
Lausanne-Sport
</td>
<td style="text-align:left;">
£1.35m
</td>
<td style="text-align:left;">
in
</td>
<td style="text-align:right;">
1.35
</td>
<td style="text-align:left;">
premier-league
</td>
<td style="text-align:right;">
2000
</td>
</tr>
<tr>
<td style="text-align:left;">
Arsenal FC
</td>
<td style="text-align:left;">
Igors StepanovsI. Stepanovs
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:left;">
Centre-Back
</td>
<td style="text-align:left;">
Skonto Riga
</td>
<td style="text-align:left;">
£1.35m
</td>
<td style="text-align:left;">
in
</td>
<td style="text-align:right;">
1.35
</td>
<td style="text-align:left;">
premier-league
</td>
<td style="text-align:right;">
2000
</td>
</tr>
</tbody>
</table>
</div>
<p>Notice the duplicated player name field 🤔 if you find a fix, holler. For more on the variables included, visit the <a href="https://github.com/ewenme/footy-transfer-data/blob/master/README.md">repo’s readme</a>.</p>
</div>
<div id="sketching-some-visuals-on-top" class="section level2">
<h2>Sketching some visuals on top</h2>
<p>Now for a couple of visualisation pieces I’ve tried out using this dataset. I’ve included some notes on my process/workflow for each<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a>, if you’re that way inclined. Otherwise, just <em>~absorb the inspiration~</em> 💡</p>
<p>I took a look at the value of player buys vs sales for Premier League clubs in the 2018/19 window, using a <a href="https://uc-r.github.io/cleveland-dot-plots">Cleveland dot plot</a> (AKA ‘dumbbell’ chart) variant.
<img src="https://github.com/ewenme/footy-transfer-data/raw/master/figures/premier-league-transfer-spend-2018-web.png" /></p>
<blockquote>
<p>This type of visualisation is an elegant and simple way to show ranges of data (i.e. spend vs sales difference) across multiple categories (i.e. football clubs). I did the initial sketch for this using my standard charting workflow in R (mostly <a href="https://ggplot2.tidyverse.org/index.html">ggplot2</a> and it’s many extensions, including <a href="https://rud.is/b/">Bob Rudis’</a> charming <a href="https://github.com/hrbrmstr/ggalt">ggalt</a> which made this chart type ), but I <em>did</em> export this into <a href="https://www.adobe.com/products/illustrator.html">Adobe Illustrator</a> (<a href="https://inkscape.org/en/">Inkscape</a> is a fine free alternative) to do good text annotations quicker. The final version therefore includes non-reproducible elements that makes refreshing the viz for new transfer windows non-trivial, but that help in telling stories contained in this view of the data. In this one-off case, I think the trade-off is fine.</p>
</blockquote>
<p>Next, a look at a single club’s season-by-season transfer spend and sales, following the relationship between these two amounts through time.</p>
<p><img src="https://github.com/ewenme/footy-transfer-data/raw/master/figures/chelsea-transfers-web.png" /></p>
<blockquote>
<p>This visualisation choice might be a little difficult to follow at first, if it’s your first connected scatter (in <a href="https://medium.com/@Elijah_Meeks/what-charts-do-48ed96f70a74">this post by Elijah Meeks</a>, the connected scatter example actually includes a link to an explanation of what’s going on). <a href="http://steveharoz.com/research/connected_scatterplot/">Steve Haroz + collaborators’ research paper</a> was invaluable in guiding my first application of this chart format. In short, they are good at showing changing data for two variables whenever there is a relatively clear pattern of progression. Similarly to the previous example, this was sketched out in R with ggplot2, with some Illustrator annotation fine-tuning.</p>
</blockquote>
<p>That’s basically it…let me know if you make something 🔥🔥🔥</p>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>You can find the R code used to generate this post <a href="https://github.com/rbind/ewenme/blob/master/content/blog/2018-08-27-building-open-transfer-data.Rmd">here</a>.<a href="#fnref1" class="footnote-back">↩</a></p></li>
<li id="fn2"><p>For this post I chose to omit lengthy passages on web scraping, as not to deter non-programmers (insights can be gleaned from the cleaned data w/o additional code). However, the code used to scrape, clean and analyse the data is publicly available within the <code>src</code> directory of the <a href="https://github.com/ewenme/footy-transfer-data">footy-transfer-data GitHub repo</a>, featuring <a href="https://github.com/hadley/rvest">rvest</a> (web scraping for R) in conjunction with <a href="https://github.com/tidyverse/purrr">purrr</a> (iteration tools for R).<a href="#fnref2" class="footnote-back">↩</a></p></li>
<li id="fn3"><p>Web scraping is a legally/ethically grey area. All effort should be made to verify if scraping a webpage is in accordance with the parent domain’s terms of use. A helpful permissions checker for R, <a href="https://github.com/ropensci/robotstxt">robotstxt</a>, is invaluable in this pursuit. Use this (or similar in other languages), or at least study the terms of use for the domain in question closely.<a href="#fnref3" class="footnote-back">↩</a></p></li>
<li id="fn4"><p>For the R code used to sketch the chart examples included in the post (and others that didn’t make the cut), try <a href="https://github.com/ewenme/footy-transfer-data/blob/master/src/02-viz.R">here</a>.<a href="#fnref4" class="footnote-back">↩</a></p></li>
</ol>
</div>

      
    </div>
    
  </div>
</section>


<section class="section">
  <div class="container has-text-centered">
    <p></p>
    
  </div>
</section>



</body>
</html>

