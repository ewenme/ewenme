<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"  lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1"/>

<title>Introducing geniusr | ewen</title>


<link rel="stylesheet" href="/css/style.css"/><link rel='stylesheet' href='/css/custom.css'></head>
<body>

<section class="section">
  <div class="container">
    <nav class="nav">
      <div class="nav-left">
        <a class="nav-item" href="/"><h1 class="title is-4">ewen</h1></a>
      </div>
      <div class="nav-right">
        <nav class="nav-item level is-mobile"><a class="level-item" href='mailto:ewenhenderson@gmail.com' target='_blank' rel='noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
    <polyline points="22,6 12,13 2,6"/>
    
  </svg></i>
            </span>
          </a><a class="level-item" href='https://github.com/ewenme' target='_blank' rel='noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"/>
    
  </svg></i>
            </span>
          </a><a class="level-item" href='https://twitter.com/ewen_' target='_blank' rel='noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"/>
    
  </svg></i>
            </span>
          </a></nav>
      </div>
    </nav>
  </div>
</section>

<section class="section">
  <div class="container">
    <div class="subtitle is-6 is-pulled-right">
      
      
<a class="subtitle is-6" href="/tags/r">#r</a>



  
  | <a class="subtitle is-6" href="/tags/package">#package</a>
  
  | <a class="subtitle is-6" href="/tags/genius">#genius</a>
  
  | <a class="subtitle is-6" href="/tags/geniusr">#geniusr</a>
  

      
    </div>
    <h2 class="subtitle is-6">December 6, 2017</h2>
    <h1 class="title">Introducing geniusr</h1>
    
    <div class="content">
      

<p>I made a new R package (ðŸ”¥ðŸ“¦ðŸ”¥) this week. My <a href="https://ewenme.rbind.io/blog/2017-03-20-kanye_sentiment_analysis/">sophomore post on this site</a> (from way back in March) was a text-based analysis of Kanye West records, which exposed me to the <a href="https://genius.com/">Genius</a> API<sup class="footnote-ref" id="fnref:documentation"><a href="#fn:documentation">1</a></sup> once I wanted to get hold of some lyrical content. In the process, I wrote some functions for playing nicely with this API in R that I knew would probably be handy for others dabbling/wanting to dabble in similar matters.</p>

<p>Since then, I&rsquo;ve found a window of time to build on and consolidate this work into a well-rounded package. <code>geniusr</code> is now <a href="https://cran.r-project.org/web/packages/geniusr/index.html">available on CRAN</a>. This is the tour.<sup class="footnote-ref" id="fnref:admin"><a href="#fn:admin">2</a></sup></p>

<h2 id="searchin">Searchin&rsquo;</h2>

<p>The Genius API&rsquo;s search capabilities allows for users to scan all hosted content on the site (i.e. all songs). A couple of quick implementations exist in the package for retrieving artist (<code>search_artist()</code>) and song (<code>search_song()</code>) matches for search terms. Let&rsquo;s start by looking for songs brought back by a simple search for &ldquo;Versace&rdquo;.</p>

<pre><code class="language-r">versace_search &lt;- search_song(search_term = &quot;Versace&quot;) %&gt;% glimpse
</code></pre>

<pre><code>## Observations: 10
## Variables: 5
## $ song_id         &lt;int&gt; 176872, 2898687, 182654, 176951, 183346, 20050...
## $ song_name       &lt;chr&gt; &quot;Versace (Remix) (Ft.Â Drake)&quot;, &quot;Versace on the...
## $ song_lyrics_url &lt;chr&gt; &quot;https://genius.com/Migos-versace-remix-lyrics...
## $ artist_id       &lt;int&gt; 44080, 500, 1319, 44080, 554, 32397, 2236, 358...
## $ artist_name     &lt;chr&gt; &quot;Migos&quot;, &quot;Bruno Mars&quot;, &quot;Meek Mill&quot;, &quot;Migos&quot;, &quot;...
</code></pre>

<h2 id="goin-meta">Goin&rsquo; Meta</h2>

<p>Wanna bring back some fuller information about a particular song (<code>get_song_meta()</code>), artist (<code>get_artist_meta()</code>) or album (<code>get_album_meta()</code>)? Well, now you can. Let&rsquo;s test one out - how about investigating a classic Versace-themed track from our last search, &lsquo;Versace&rsquo; by Migos.</p>

<pre><code class="language-r">versace_meta &lt;- get_song_meta(song_id = versace_search$song_id[4]) %&gt;% glimpse
</code></pre>

<pre><code>## Observations: 1
## Variables: 13
## $ song_id            &lt;int&gt; 176951
## $ song_name          &lt;chr&gt; &quot;Versace&quot;
## $ song_lyrics_url    &lt;chr&gt; &quot;https://genius.com/Migos-versace-lyrics&quot;
## $ song_art_image_url &lt;chr&gt; &quot;https://images.genius.com/4fe960be500117d6...
## $ release_date       &lt;chr&gt; &quot;2013-07-09&quot;
## $ pageviews          &lt;int&gt; 118683
## $ annotation_count   &lt;int&gt; 24
## $ artist_id          &lt;int&gt; 44080
## $ artist_name        &lt;chr&gt; &quot;Migos&quot;
## $ artist_url         &lt;chr&gt; &quot;https://genius.com/artists/Migos&quot;
## $ album_id           &lt;int&gt; 36011
## $ album_name         &lt;chr&gt; &quot;Young Rich Niggas&quot;
## $ album_url          &lt;chr&gt; &quot;https://genius.com/albums/Migos/Young-rich...
</code></pre>

<p>With this metadata, we can easily pull up the song&rsquo;s artwork, for example. Why not.</p>

<pre><code class="language-r">knitr::include_graphics(path = versace_meta$song_art_image_url)
</code></pre>

<p><img src="https://images.genius.com/4fe960be500117d652f0e856ce0b61ce.316x316x1.jpg" width="75%" style="display: block; margin: auto;" /></p>

<h2 id="gettin-lyrical">Gettin&rsquo; Lyrical</h2>

<p>The package allows you to grab lyrics for tracks real quick, using the <code>scrape_lyrics_id()</code> (or <code>scrape_lyrics_url()</code>) function.<sup class="footnote-ref" id="fnref:scrape"><a href="#fn:scrape">3</a></sup> While we&rsquo;re at it, let&rsquo;s call on <code>tidytext</code> and answer a question for the people - <em>just how much were the Migos chatting about &ldquo;Versace&rdquo; in &lsquo;Versace&rsquo;?</em></p>

<pre><code class="language-r"># get words proportion representation
versace_prop &lt;- scrape_lyrics_url(versace_meta$song_lyrics_url) %&gt;%
  unnest_tokens(word, line) %&gt;%
  count(word) %&gt;%
  mutate(proportion = n / sum(n)) %&gt;%
  # was the word versace or the rest
  mutate(versace_or_the_rest=if_else(word == &quot;versace&quot;, &quot;Versace&quot;, &quot;Not Versace&quot;)) %&gt;%
  group_by(versace_or_the_rest) %&gt;%
  summarise(proportion=sum(proportion)*100)

# waffle plot
parts &lt;- c(&quot;Not Versace&quot; = versace_prop$proportion[[1]],
           &quot;Versace&quot; = versace_prop$proportion[[2]])

waffle(parts, rows = 8, size = 1, colors = c(&quot;#3C3A32&quot;, &quot;#E3BD08&quot;), use_glyph = &quot;volume-up&quot;, 
       glyph_size = 10, title = &quot;How much Versace is in Migos - 'Versace'?&quot;) +
  labs(caption=&quot;@ewen_&quot;) +
  theme_void(base_family = &quot;Work Sans&quot;, base_size = 12) +
  theme(legend.position = &quot;bottom&quot;)
</code></pre>

<p><img src="introducing-geniusr_files/figure-html/lyrics-1.svg" width="672" /></p>

<p>The word &ldquo;Versace&rdquo; represents 32.5% of the lyrics in Migos - Versace. Phew.</p>

<p>That&rsquo;s all for now, enjoy the package and keep up with future developments over at the <a href="https://github.com/ewenme/geniusr">GitHub repo</a>.</p>
<div class="footnotes">

<hr />

<ol>
<li id="fn:documentation">Genius&rsquo; <a href="https://docs.genius.com/">documentation pages</a> are helpful if you want to know more about the API.
 <a class="footnote-return" href="#fnref:documentation"><sup>[return]</sup></a></li>
<li id="fn:admin">For installation &amp; authentication guidance, head for the <a href="https://github.com/ewenme/geniusr">README</a>.
 <a class="footnote-return" href="#fnref:admin"><sup>[return]</sup></a></li>
<li id="fn:scrape">As well as API helper functions, the package includes things that are scraping the Genius site (Genius&rsquo; API doesn&rsquo;t include lyrics, for example). Be sure to read the <a href="https://genius.com/static/terms">terms of service</a> in case of any concerns.
 <a class="footnote-return" href="#fnref:scrape"><sup>[return]</sup></a></li>
</ol>
</div>

      
    </div>
    
  </div>
</section>


<section class="section">
  <div class="container has-text-centered">
    <p>&copy; Ewen Henderson </a> 2017-18</p>
    
  </div>
</section>

</body>
</html>

